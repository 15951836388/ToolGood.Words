function WordsSearch(){function u(){this.Layer=this.Index=0;this.End=!1;this.Char="";this.Results=[];this.m_values={};this.Parent=this.Failure=null;this.Add=function(a){if(null!=this.m_values[a])return this.m_values[a];var b=new u;b.Parent=this;b.Char=a;return this.m_values[a]=b};this.SetResults=function(a){0==this.End&&(this.End=!0);this.Results.push(a)}}function v(){this.End=!1;this.Results=[];this.m_values={};this.minflag=65535;this.maxflag=0;this.Add=function(a,b){this.minflag>a&&(this.minflag=a);this.maxflag<a&&(this.maxflag=a);this.m_values[a]=b};this.SetResults=function(a){0==this.End&&(this.End=!0);-1==this.Results.indexOf(a)&&this.Results.push(a)};this.HasKey=function(a){return void 0!=this.m_values[a]};this.TryGetValue=function(a){return this.minflag<=a&&this.maxflag>=a?this.m_values[a]:null}}function p(a,b,d){b=void 0===b?0:b;d=d||a.length;if(b<d-1){for(var e=d,c=a[e-1].Layer,f=b-1,g=b;g<e-1;g++)if(a[g].Layer<=c){f++;var k=a,h=g,l=k[f];k[f]=k[h];k[h]=l}c=f+1;--e;g=a[c];a[c]=a[e];a[e]=g;f+=1;p(a,b,f);p(a,f+1,d)}return a}function w(a){return 1>=a.length?a:p(arguments,0,arguments.length)}var m=[],n=[],t=[];this.SetKeywords=function(a){n=a;for(var b=0;b<a.length;b++)t.push(b);a=new u;b=[];b.push(a);for(var d=0;d<n.length;d++){for(var e=n[d],c=a,f=0;f<e.length;f++)c=c.Add(e.charCodeAt(f)),0==c.Layer&&(c.Layer=f+1,b.push(c));c.SetResults(d)}var d=[],g;for(g in a.m_values)if(0!=a.m_values.hasOwnProperty(g)){c=a.m_values[g];c.Failure=a;for(var k in c.m_values)0!=c.m_values.hasOwnProperty(k)&&d.push(c.m_values[k])}for(;0!=d.length;){k=[];for(g in d)if(0!=d.hasOwnProperty(g)){c=d[g];e=c.Parent.Failure;for(f=c.Char;null!=e&&!e.m_values[f];)e=e.Failure;if(null==e)c.Failure=a;else{c.Failure=e.m_values[f];for(var h in c.Failure.Results)0!=c.Failure.Results.hasOwnProperty(h)&&c.SetResults(c.Failure.Results[h])}for(var l in c.m_values)0!=c.m_values.hasOwnProperty(l)&&k.push(c.m_values[l])}d=k}a.Failure=a;b=w(b)[0];for(d=0;d<b.length;d++)b[d].Index=d;g=[];for(d=0;d<b.length;d++)g.push(new v);for(d=0;d<g.length;d++){h=b[d];l=g[d];for(var q in h.m_values)0!=h.m_values.hasOwnProperty(q)&&(c=h.m_values[q].Index,l.Add(q,g[c]));for(c=0;c<h.Results.length;c++)l.SetResults(h.Results[c]);if(h.Failure!=a){for(var r in h.Failure.m_values)0!=h.Failure.m_values.hasOwnProperty(r)&&0==l.HasKey(r)&&(c=h.Failure.m_values[r].Index,l.Add(r,g[c]));for(c=0;c<h.Failure.Results.length;c++)l.SetResults(h.Failure.Results[c])}}q=[];for(r=0;65535>r;r++)q.push(null);for(var p in g[0].m_values)0!=g[0].m_values.hasOwnProperty(p)&&(q[p]=g[0].m_values[p]);m=q};this.FindFirst=function(a){for(var b=null,d=0;d<a.length;d++){var e=a.charCodeAt(d);null==b?b=m[e]:(b=b.TryGetValue(e))||(b=m[e]);if(null!=b&&b.End)return a=b.Results[0],{Keyword:n[a],Success:!0,End:d,Start:d+1-n[a].length,Index:t[a]}}return null};this.FindAll=function(a){for(var b=null,d=[],e=0;e<a.length;e++){var c=a.charCodeAt(e);null==b?b=m[c]:(b=b.TryGetValue(c))||(b=m[c]);if(null!=b&&b.End)for(c=0;c<b.Results.length;c++){var f=b.Results[c];d.push({Keyword:n[f],Success:!0,End:e,Start:e+1-n[f].length,Index:t[f]})}}return d};this.ContainsAny=function(a){for(var b=null,d=0;d<a.length;d++){var e=a.charCodeAt(d);null==b?b=m[e]:(b=b.TryGetValue(e))||(b=m[e]);if(null!=b&&b.End)return!0}return!1};this.Replace=function(a,b){b=void 0===b?"*":b;for(var d=a.split(""),e=null,c=0;c<a.length;c++){var f=a.charCodeAt(c);null==e?e=m[f]:(e=e.TryGetValue(f))||(e=m[f]);if(null!=e&&e.End)for(f=c+1-n[e.Results[0]].length;f<=c;f++)d[f]=b}return d.join("")}};